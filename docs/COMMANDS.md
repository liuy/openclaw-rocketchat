[首页](../README.md) · [使用指南](GUIDE.md) · [常见问题](FAQ.md) · [配置参数](CONFIGURATION.md) · [架构](ARCHITECTURE.md) · [安全](SECURITY.md) · [多 Agent](MULTI-AGENT.md) · [多渠道](MULTI-CHANNEL.md) · [命令](COMMANDS.md)

# 命令参考

## 为什么用 `!` 而不是 `/`？

Rocket.Chat 客户端内置了一系列 `/` 斜杠命令（如 `/help`、`/join`、`/leave`、`/mute` 等）。当你输入 `/` 开头的消息时，**Rocket.Chat 客户端会直接拦截**，消息不会发送给 AI 机器人。

为了避免冲突，在 Rocket.Chat 中使用 **`!` 前缀**代替 `/` 来调用 OpenClaw 命令。插件会自动将 `!xxx` 转换为 OpenClaw 的 `/xxx` 命令。

> **重要：** 这些命令是 **OpenClaw 官方内置**的功能，不是本插件额外添加的。本插件只是做了前缀翻译（`!` → `/`），让你在 Rocket.Chat 中也能正常使用它们。

---

## 上下文管理

管理对话上下文和会话状态，是最常用的一组命令：

| 命令格式 | 自然语言格式 | 功能 |
|---------|------------|------|
| `!compact` | `压缩对话` `压缩上下文` | 对话变卡/变慢时用。强制压缩旧消息，释放上下文窗口空间 |
| `!clear` | `清除会话` | 清除当前会话的消息记录，但**保留 AI 的长期记忆** |
| `!reset` | `重置对话` `清空对话` | 彻底重新开始。清空所有上下文、记忆，回到初始状态 |
| `!new` | `新对话` `开始新对话` | 开始全新对话，可以顺便切换模型（如 `!new glm`） |
| `!status` | `查看状态` `当前状态` | 查看当前 Agent、模型、token 使用量等运行状态 |

### 三种"清理"的区别

| 命令 | 清除消息 | 清除记忆 | 切换模型 | 适用场景 |
|------|:---:|:---:|:---:|---------|
| `!compact` | 压缩旧消息 | ❌ 保留 | ❌ | 对话太长变卡了 |
| `!clear` | ✅ 全部清除 | ❌ 保留 | ❌ | 想换个话题，但 AI 还记得你 |
| `!reset` | ✅ 全部清除 | ✅ 全部清除 | ❌ | 完全重新开始 |
| `!new` | ✅ 全部清除 | ✅ 全部清除 | ✅ 可选 | 重新开始并换模型 |

---

## 模型切换

查看和切换 AI 模型：

| 命令格式 | 自然语言格式 | 功能 |
|---------|------------|------|
| `!model` | `切换模型` `查看模型` | 显示可用模型列表（带编号），输入编号即可切换 |
| `!model list` | `模型列表` | 显示可用模型列表 |
| `!model status` | — | 查看当前模型的详细配置（API 地址、密钥状态等） |
| `!model <名称>` | — | 快速切换模型（模糊匹配，如 `!model glm`、`!model claude`） |
| `!model <编号>` | — | 按模型列表中的编号切换（如 `!model 3`） |

### 示例

```
!model              ← 显示模型列表（带编号）
!model 3            ← 选择列表中第 3 个模型
!model glm          ← 模糊匹配，切换到 GLM 系列
!model openai/gpt-5 ← 精确指定 provider/model
!model status       ← 查看当前模型的 API 配置详情
```

---

## 工具和技能

查看和使用 Agent 的工具（Tools）和技能（Skills）：

| 命令格式 | 自然语言格式 | 功能 |
|---------|------------|------|
| `!tools` | `查看工具` `工具列表` | 列出当前 Agent 可用的所有工具 |
| `!skills` | `查看技能` `技能列表` | 列出已安装的技能（Skill） |
| `!skill <名称>` | — | 运行指定的技能（如 `!skill summarize`） |

> 工具（Tools）是 Agent 可以调用的功能接口（如搜索、计算、文件操作等）。
> 技能（Skills）是预定义的复杂任务流程（如总结文档、翻译、代码审查等）。

---

## AI 行为控制

精细调整 AI 的输出行为：

| 命令格式 | 自然语言格式 | 功能 |
|---------|------------|------|
| `!think <级别>` | `思考深度` | 设置 AI 推理深度，影响回复质量和速度 |
| `!reasoning <on/off>` | — | 开启后 AI 会单独输出一条推理过程（默认关闭） |
| `!verbose <on/off>` | — | 开启后显示调试信息、工具调用细节等（默认关闭） |
| `!usage <级别>` | `查看用量` `用量统计` | 控制每条回复后的用量统计显示 |
| `!context` | `查看上下文` `上下文信息` | 显示上下文窗口的大小和构成明细 |
| `!abort` | `停止回复` `终止回复` | 立即终止 AI 正在生成的回复 |

### `!think` 级别说明

| 级别 | 速度 | Token 消耗 | 适用场景 |
|------|:---:|:---:|---------|
| `off` | 最快 | 最少 | 简单问答、闲聊 |
| `minimal` | 很快 | 较少 | 日常对话 |
| `low` | 快 | 适中 | 一般任务（默认） |
| `medium` | 中等 | 较多 | 复杂分析、长文写作 |
| `high` | 较慢 | 最多 | 数学推理、代码调试、复杂决策 |

### `!usage` 级别说明

| 级别 | 说明 |
|------|------|
| `off` | 不显示用量信息 |
| `tokens` | 每条回复后显示 token 数量 |
| `full` | 显示完整的 token 和费用明细 |
| `cost` | 汇总本次会话的累计费用 |

> **注意：** `!verbose` 和 `!reasoning` 在群组中使用时要小心，可能会暴露 AI 的内部推理过程和工具调用细节给群内所有人。

---

## 信息查询

查看各种运行时信息：

| 命令格式 | 自然语言格式 | 功能 |
|---------|------------|------|
| `!help` | `命令帮助` `命令列表` `查看命令` | 显示命令帮助菜单 |
| `!commands` | — | 查看 OpenClaw 完整命令列表（比 `!help` 更详细） |
| `!agents` | `代理列表` `查看代理` | 查看可用的 Agent 列表及当前绑定 |
| `!agent <id>` | — | 查看或切换到指定 Agent |
| `!whoami` | — | 查看你的发送者身份标识（调试用） |

---

## 管理命令

需要管理员权限或特殊配置才能使用：

| 命令格式 | 功能 |
|---------|------|
| `!elevated <on/off/ask/full>` | 管理权限提升级别（`full` 跳过所有执行审批） |
| `!exec` | 查看或配置代码执行沙箱行为 |
| `!activation <mention/always>` | 设置群组激活模式（@提及/始终响应） |
| `!session` / `!sessions` | 查看当前或所有会话信息 |
| `!approve <allow-once/deny>` | 审批代码执行请求 |
| `!subagents` | 查看或管理子 Agent 的运行状态 |
| `!config` | 查看或修改持久配置（需 `commands.config: true`） |
| `!debug` | 运行时调试覆盖（需 `commands.debug: true`） |

> 管理命令需要发送者在 `commands.allowFrom` 白名单中。未授权用户发送这些命令会被静默忽略。

---

## 不适用的命令

以下 OpenClaw 命令在 Rocket.Chat 中**不适用或不推荐使用**：

| 命令 | 原因 |
|------|------|
| `!bash` / `! 命令` | 在服务器上执行 shell 命令，安全风险极高，默认禁用 |
| `!dock-slack` / `!dock-telegram` | 跨渠道对接，仅在对应平台有意义 |
| `!restart` / `!stop` | Gateway 服务控制，默认禁用 |
| `!send` | 所有者专用，控制消息发送行为 |
| `!tts` | 语音合成，Rocket.Chat App 不支持 TTS |
| `!queue` | 消息队列高级设置，一般不需要手动调整 |

---

## 使用方式

### 方式一：命令格式

以 `!` 开头，后跟命令名：

```
!compact
!model glm
!think high
!status
```

> **注意：** `!` 必须是消息的**第一个字符**。消息中间出现的感叹号不会被当作命令。
> 例如 `太好了！reset` 不会触发命令。

### 方式二：自然语言格式

直接发送对应的自然语言短语（需完整匹配一条消息）：

```
压缩对话
切换模型
查看状态
```

> **注意：** 自然语言必须是**完整的一条消息**，且**完全匹配**上表中的短语。
> 例如 `重置对话` 会触发重置，但 `帮我重置对话` 不会（会被当作普通消息发给 AI）。

---

## 💡 最常用的命令

| 场景 | 命令 | 说明 |
|------|------|------|
| 对话变卡变慢 | `!compact` | 压缩旧消息，释放空间 |
| 想换个模型试试 | `!model glm` | 快速切换到 GLM 模型 |
| 看看 token 用了多少 | `!status` | 查看用量和状态 |
| 完全重新开始 | `!reset` | 清空一切，回到初始状态 |
| AI 回复太慢想打断 | `!abort` | 立即终止当前回复 |
| 换个话题但别忘了我 | `!clear` | 清消息但保留记忆 |

---

## 在群组中使用

群组中的命令使用与私聊相同。如果群组开启了 `@提及` 模式（`requireMention: true`），需要先 @机器人：

```
@molty !reset
@molty !model glm
@molty !think high
```

在不需要 @提及的群组中，直接发送命令即可。

---

## 扩展性

所有 `!xxx` 都会自动转换为 OpenClaw 的 `/xxx` 命令。如果 OpenClaw 未来新增了命令，你直接用 `!` 前缀就能调用，**无需等待插件更新**。

OpenClaw 的插件（如 OpenProse）注册的自定义命令同样可以通过 `!` 前缀在 Rocket.Chat 中使用。
